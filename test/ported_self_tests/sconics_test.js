var assert = require('assert'),
    api = require('../../'),
    helpers = require('../helpers');

describe('sconics.js', function () {

  var fwd_in = [
    [ 2, 1],
    [ 2,-1],
    [-2, 1],
    [-2,-1]
  ];

  var inv_in = [
   [ 200, 100],
   [ 200,-100],
   [-200, 100],
   [-200,-100]
  ];

  describe('Euler', function () {

    var s_fwd_expect = [
    [223360.65559869423,  111786.11238979101],
    [223530.76769031584,  -111615.96709862351],
    [-223360.65559869423,  111786.11238979101],
    [-223530.76769031584,  -111615.96709862351]
    ];

    var s_inv_expect = [
    [0.0017901444369360026,  0.00089524594522202015],
    [0.001790143216840731,  -0.00089524716533368484],
    [-0.0017901444369360026,  0.00089524594522202015],
    [-0.001790143216840731,  -0.00089524716533368484]
    ];

    var e_fwd_expect = [
    [222597.63465910763,  111404.24054991946],
    [222767.16563187627,  -111234.6764910177],
    [-222597.63465910763,  111404.24054991946],
    [-222767.16563187627,  -111234.6764910177]
    ];

    var e_inv_expect = [
    [0.0017962807023075235,  0.0008983146697688839],
    [0.0017962794738334226,  -0.00089831589842987965],
    [-0.0017962807023075235,  0.0008983146697688839],
    [-0.0017962794738334226,  -0.00089831589842987965]
    ];

    var sargs = "+proj=euler   +a=6400000    +lat_1=0.5 +lat_2=2 +n=0.5";
    var eargs = "+proj=euler   +ellps=GRS80  +lat_1=0.5 +lat_2=2 +n=0.5";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

  describe('Murdoch I', function () {

    var s_fwd_expect = [
    [223363.84530949194,  111786.11603286299],
    [223533.96225925098,  -111615.96345182261],
    [-223363.84530949194,  111786.11603286299],
    [-223533.96225925098,  -111615.96345182261]
    ];

    var s_inv_expect = [
    [0.0017901188633413715,  0.00089524594522202015],
    [0.0017901176432461162,  -0.00089524716492657387],
    [-0.0017901188633413715,  0.00089524594522202015],
    [-0.0017901176432461162,  -0.00089524716492657387]
    ];

    var e_fwd_expect = [
    [222600.81347355421,  111404.24418054636],
    [222770.3492878644,  -111234.6728566746],
    [-222600.81347355421,  111404.24418054636],
    [-222770.3492878644,  -111234.6728566746]
    ];

    var e_inv_expect = [
    [0.0017962550410516366,  0.0008983146697688839],
    [0.0017962538125775522,  -0.00089831589842987965],
    [-0.0017962550410516366,  0.0008983146697688839],
    [-0.0017962538125775522,  -0.00089831589842987965]
    ];

    var sargs = "+proj=murd1   +a=6400000    +lat_1=0.5 +lat_2=2 +n=0.5";
    var eargs = "+proj=murd1   +ellps=GRS80  +lat_1=0.5 +lat_2=2 +n=0.5";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

  describe('Murdoch II', function () {

    var s_fwd_expect = [
    [223351.08800702673,  111808.08693438848],
    [223521.2959691704,  -111723.08785967289],
    [-223351.08800702673,  111808.08693438848],
    [-223521.2959691704,  -111723.08785967289]
    ];

    var s_inv_expect = [
    [0.0017902209670287586,  0.00089482021163422854],
    [0.0017902197468465887,  -0.00089482082161134206],
    [-0.0017902209670287586,  0.00089482021163422854],
    [-0.0017902197468465887,  -0.00089482082161134206]
    ];

    var e_fwd_expect = [
    [222588.09975123021,  111426.14002741246],
    [222757.72626701824,  -111341.43131750476],
    [-222588.09975123021,  111426.14002741246],
    [-222757.72626701824,  -111341.43131750476]
    ];

    var e_inv_expect = [
    [0.0017963574947305447,  0.00089788747830845382],
    [0.0017963562661689487,  -0.00089788809264252983],
    [-0.0017963574947305447,  0.00089788747830845382],
    [-0.0017963562661689487,  -0.00089788809264252983]
    ];

    var sargs = "+proj=murd2   +a=6400000    +lat_1=0.5 +lat_2=2 +n=0.5";
    var eargs = "+proj=murd2   +ellps=GRS80  +lat_1=0.5 +lat_2=2 +n=0.5";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

  describe('Murdoch III', function () {

    var s_fwd_expect = [
    [223363.84591558515,  111786.11846198692],
    [223533.96772395336,  -111615.96101901523],
    [-223363.84591558515,  111786.11846198692],
    [-223533.96772395336,  -111615.96101901523]
    ];

    var s_inv_expect = [
    [0.0017901188390313859,  0.00089524594522202015],
    [0.0017901176189013177,  -0.00089524716533368484],
    [-0.0017901188390313859,  0.00089524594522202015],
    [-0.0017901176189013177,  -0.00089524716533368484]
    ];

    var e_fwd_expect = [
    [222600.81407757697,  111404.24660137216],
    [222770.35473389886,  -111234.67043217793],
    [-222600.81407757697,  111404.24660137216],
    [-222770.35473389886,  -111234.67043217793]
    ];

    var e_inv_expect = [
    [0.0017962550166583809,  0.0008983146697688839],
    [0.0017962537881492445,  -0.00089831589842987965],
    [-0.0017962550166583809,  0.0008983146697688839],
    [-0.0017962537881492445,  -0.00089831589842987965]
    ];

    var sargs = "+proj=murd3   +a=6400000    +lat_1=0.5 +lat_2=2 +n=0.5";
    var eargs = "+proj=murd3   +ellps=GRS80  +lat_1=0.5 +lat_2=2 +n=0.5";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

  describe('Perspective Conic', function () {

    var s_fwd_expect = [
    [223351.08709429545,  111798.5189920546],
    [223521.28776521701,  -111713.50533845725],
    [-223351.08709429545,  111798.5189920546],
    [-223521.28776521701,  -111713.50533845725]
    ];

    var s_inv_expect = [
    [0.0017902210035514285,  0.0008948968793741558],
    [0.0017902197833169374,  -0.00089489748965381963],
    [-0.0017902210035514285,  0.0008948968793741558],
    [-0.0017902197833169374,  -0.00089489748965381963]
    ];

    var e_fwd_expect = [
    [222588.09884161691,  111416.60477006658],
    [222757.71809109033,  -111331.88153107995],
    [-222588.09884161691,  111416.60477006658],
    [-222757.71809109033,  -111331.88153107995]
    ];

    var e_inv_expect = [
    [0.0017963575313784969,  0.0008979644089172499],
    [0.0017963563027642206,  -0.00089796502355327969],
    [-0.0017963575313784969,  0.0008979644089172499],
    [-0.0017963563027642206,  -0.00089796502355327969]
    ];

    var sargs = "+proj=pconic   +a=6400000    +lat_1=0.5 +lat_2=2 +n=0.5";
    var eargs = "+proj=pconic   +ellps=GRS80  +lat_1=0.5 +lat_2=2 +n=0.5";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

  describe('Tissot', function () {

    var s_fwd_expect = [
    [223404.24855684943,  54534.122161157939],
    [223574.36550660848,  -168867.95732352766],
    [-223404.24855684943,  54534.122161157939],
    [-223574.36550660848,  -168867.95732352766]
    ];

    var s_inv_expect = [
    [0.0017901444453421915,  0.51344188640609856],
    [0.001790143225212064,  0.51165139329554277],
    [-0.0017901444453421915,  0.51344188640609856],
    [-0.001790143225212064,  0.51165139329554277]
    ];

    var e_fwd_expect = [
    [222641.07869963095,  54347.828487281469],
    [222810.61451394114,  -168291.08854993948],
    [-222641.07869963095,  54347.828487281469],
    [-222810.61451394114,  -168291.08854993948]
    ];

    var e_inv_expect = [
    [0.0017962807107425871,  0.51344495513064536],
    [0.0017962794822333915,  0.51164832456244658],
    [-0.0017962807107425871,  0.51344495513064536],
    [-0.0017962794822333915,  0.51164832456244658]
    ];

    var sargs = "+proj=tissot   +a=6400000    +lat_1=0.5 +lat_2=2 +n=0.5";
    var eargs = "+proj=tissot   +ellps=GRS80  +lat_1=0.5 +lat_2=2 +n=0.5";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

  describe('Vitkovsky I', function () {

    var s_fwd_expect = [
    [223370.22484047143,  111786.12331964359],
    [223540.3515072545,  -111615.9561576751],
    [-223370.22484047143,  111786.12331964359],
    [-223540.3515072545,  -111615.9561576751]
    ];

    var s_inv_expect = [
    [0.0017900677174648159,  0.00089524594522202015],
    [0.0017900664973695916,  -0.00089524716533368484],
    [-0.0017900677174648159,  0.00089524594522202015],
    [-0.0017900664973695916,  -0.00089524716533368484]
    ];

    var e_fwd_expect = [
    [222607.17121145778,  111404.25144243463],
    [222776.71670959776,  -111234.66558744459],
    [-222607.17121145778,  111404.25144243463],
    [-222776.71670959776,  -111234.66558744459]
    ];

    var e_inv_expect = [
    [0.0017962037198570686,  0.0008983146697688839],
    [0.0017962024913830157,  -0.00089831589842987965],
    [-0.0017962037198570686,  0.0008983146697688839],
    [-0.0017962024913830157,  -0.00089831589842987965]
    ];

    var sargs = "+proj=vitk1   +a=6400000    +lat_1=0.5 +lat_2=2 +n=0.5";
    var eargs = "+proj=vitk1   +ellps=GRS80  +lat_1=0.5 +lat_2=2 +n=0.5";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

});
