var assert = require('assert'),
    api = require('../../'),
    helpers = require('../helpers');

describe('healpix.js', function () {

  var fwd_in = [
    [ 2, 1],
    [ 2,-1],
    [-2, 1],
    [-2,-1]
  ];

  var inv_in = [
    [ 200, 100],
    [ 200,-100],
    [-200, 100],
    [-200,-100]
  ];

  describe('Healpix', function () {

    var s_fwd_expect = [
      [ 223402.14425527418,  131588.04444199943],
      [ 223402.14425527418, -131588.04444199943],
      [-223402.14425527418,  131588.04444199943],
      [-223402.14425527418, -131588.04444199943]
    ];

    var s_inv_expect = [
      [ 0.0017904931097838226,  0.00075990887733981202],
      [ 0.0017904931097838226, -0.00075990887733981202],
      [-0.0017904931097838226,  0.00075990887733981202],
      [-0.0017904931097838226, -0.00075990887733981202]
    ];

    var e_fwd_expect = [
      [ 222390.10394923863,  130406.58866448226],
      [ 222390.10394923863, -130406.58866448054],
      [-222390.10394923863,  130406.58866448226],
      [-222390.10394923863, -130406.58866448054]
    ];

    var e_inv_expect = [
      [ 0.0017986411845524453,  0.00076679453057823619],
      [ 0.0017986411845524453, -0.00076679453057823619],
      [-0.0017986411845524453,  0.00076679453057823619],
      [-0.0017986411845524453, -0.00076679453057823619]
    ];

    var sargs = "+proj=healpix   +R=6400000    +lat_1=0 +lat_2=2";
    var eargs = "+proj=healpix   +ellps=GRS80  +lat_1=0 +lat_2=2";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

  describe('rHealpix', function () {
    var s_fwd_expect = [
      [ 223402.14425527418,  131588.04444199943],
      [ 223402.14425527418, -131588.04444199943],
      [-223402.14425527418,  131588.04444199943],
      [-223402.14425527418, -131588.04444199943]
    ];

    var s_inv_expect = [
      [ 0.0017904931097838226,  0.00075990887733981202],
      [ 0.0017904931097838226, -0.00075990887733981202],
      [-0.0017904931097838226,  0.00075990887733981202],
      [-0.0017904931097838226, -0.00075990887733981202]
    ];

    var e_fwd_expect = [
      [ 222390.10394923863,  130406.58866448226],
      [ 222390.10394923863, -130406.58866448054],
      [-222390.10394923863,  130406.58866448226],
      [-222390.10394923863, -130406.58866448054]
    ];

    var e_inv_expect = [
      [ 0.0017986411845524453,  0.00076679453057823619],
      [ 0.0017986411845524453, -0.00076679453057823619],
      [-0.0017986411845524453,  0.00076679453057823619],
      [-0.0017986411845524453, -0.00076679453057823619]
    ];

    var sargs = "+proj=rhealpix   +a=6400000    +lat_1=0 +lat_2=2";
    var eargs = "+proj=rhealpix   +ellps=GRS80  +lat_1=0 +lat_2=2";

    helpers.fwd_test(sargs, fwd_in, s_fwd_expect);
    helpers.inv_test(sargs, inv_in, s_inv_expect);
    helpers.fwd_test(eargs, fwd_in, e_fwd_expect);
    helpers.inv_test(eargs, inv_in, e_inv_expect);
  })

});
